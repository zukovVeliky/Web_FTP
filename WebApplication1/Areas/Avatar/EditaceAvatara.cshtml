
@model Avatar.EditaceAvataraModel
@{
}

<script src="~/lib/Avatar/croppie.js"></script>
<script src="~/lib/Avatar/EditaceAvatara.js"></script>


<link href="~/lib/Avatar/croppie.css" rel="stylesheet" />
<style>
    /* Zajistit že croppie kontejner nepřetéká */
    .croppie-container {
        max-width: 100%;
        overflow: hidden;
        position: relative;
    }
    
    .croppie-container .cr-boundary {
        max-width: 100%;
        overflow: hidden;
    }
    
    .croppie-container img {
        max-width: 100%;
        height: auto;
        object-fit: contain;
    }
    
    /* Disable dragging by default */
    .croppie-container.drag-disabled {
        pointer-events: none;
    }
    
    .croppie-container.drag-disabled .cr-boundary {
        cursor: not-allowed;
    }
    
    /* Enable dragging when CTRL is pressed */
    .croppie-container.drag-enabled {
        pointer-events: auto;
    }
    
    .croppie-container.drag-enabled .cr-boundary {
        cursor: move;
    }
</style>

<input id="HiddenParametry_@Model.Modifikator" name="HiddenParametry_@Model.Modifikator" type="hidden" value="@Model.stringHodnotNastaveni" />

@if (Model.typZobrazeni == "circle")
{
    <div id="Contejner_@Model.Modifikator" class="ContejnerEA croppie-container drag-disabled" style="width:@Model.PixelValue(Model.Width);height:@Model.PixelValue(Model.Height); max-width: 100%;"></div>
}
else
{
    <div id="Contejner_@Model.Modifikator" class="croppie-container drag-disabled" style="width: 100%; max-width: @Model.PixelValue(Model.Width);height:@Model.PixelValue(Model.Height);"></div>
}





<script>
        document.addEventListener('DOMContentLoaded', function () {
        EditaceAvataraCircleSquare('@Model.typZobrazeni'); EditaceAvatara('Contejner_@Model.Modifikator', 'HiddenParametry_@Model.Modifikator');
        });


    window.ZachyceniURL_@Model.Modifikator = function (AvatarURL) {
        var pole = document.getElementById('HiddenParametry_@Model.Modifikator').value.split('~');
        document.getElementById('HiddenParametry_@Model.Modifikator').value = AvatarURL + "~0~0~0~0~0~" + pole[6] + "~" + pole[7];

        // Bind croppie
        const contejner = document.getElementById("Contejner_@Model.Modifikator");
        const hidden = document.getElementById('HiddenParametry_@Model.Modifikator');
        if (contejner && contejner.croppieInstance) {
            contejner.croppieInstance.bind({
                url: AvatarURL
            }).then(function () {
                if (typeof UpdateHiddenFromCroppie === 'function') {
                    UpdateHiddenFromCroppie(contejner, hidden);
                }
            });
        }

        //EditaceAvatara('Contejner', 'HiddenParametry');
    }

</script>








